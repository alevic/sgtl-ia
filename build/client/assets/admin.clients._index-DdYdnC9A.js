import{a as I,w as A,u as V,c as D,L as C}from"./chunk-JZWAC4HX-DumfKpwM.js";import{r as h,j as e,a as L}from"./forgot-password-Cd1Knve9.js";import{a as x}from"./api-Bkf04Nmd.js";import{c as O}from"./createLucideIcon-C45Xejds.js";import{E as z}from"./eye-D6sHawNO.js";import{S as B}from"./square-pen-DbBn1E1l.js";import{T as S}from"./trash-2-BO5CKzGP.js";import{C as M}from"./card-Cg68uFrF.js";import{B as _}from"./badge-OnEQOSZY.js";import{B as U}from"./button-D5icbzZz.js";import{I as F}from"./input-emgR2opu.js";import{A as G,a as q}from"./avatar-NOAFfuWM.js";import{T as H,a as W,b as f}from"./tabs-C5PlI2Of.js";import{T as J,a as K,b as y,c as b,d as Q,e as g}from"./table-B8EXJzV4.js";import{P as X}from"./PageHeader-BWRrOg2b.js";import{D as v}from"./DashboardCard-CAo4eudV.js";import{L as Y}from"./ListFilterSection-C2yv81r0.js";import{c as Z}from"./utils-CDN07tui.js";import{U as u}from"./users-BFoA2Uj7.js";import{U as $}from"./user-plus-CLYU4vXU.js";import{S as E}from"./star-jM7IWhSt.js";import{T as ee}from"./trending-up-BKzFUhqw.js";import{A as te}from"./award-CISDC_7z.js";import{S as se}from"./search-CnuVL9vz.js";import{M as ae}from"./mail-DgcRa5qp.js";import{P as re}from"./phone-hZYhS4mS.js";import"./index-CzPzUr9r.js";import"./index-Ds5WWjjE.js";import"./index-BHI_vTdI.js";import"./index-r0Cach5g.js";import"./index-Cu73DSvi.js";import"./index-CGIZjBuz.js";import"./index-CNk52wy-.js";import"./index-BTyV9z74.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],oe=O("ellipsis-vertical",le),ne={getAll:async t=>{const a=t?`?search=${t}`:"";return x.get(`/api/clients${a}`)},getById:async t=>x.get(`/api/clients/${t}`),create:async t=>x.post("/api/clients",t),update:async(t,a)=>x.put(`/api/clients/${t}`,a),delete:async t=>x.delete(`/api/clients/${t}`),getInteractions:async t=>x.get(`/api/clients/${t}/interactions`),addInteraction:async(t,a)=>x.post(`/api/clients/${t}/interactions`,a),getNotes:async t=>x.get(`/api/clients/${t}/notes`),addNote:async(t,a)=>x.post(`/api/clients/${t}/notes`,a)},P=t=>t.length>0&&"actions"in t[0],ie=t=>P(t)?t.flatMap(a=>a.actions):t,de=(t="slate",a)=>{const i="p-2 rounded-lg transition-colors",c=a?"opacity-50 cursor-not-allowed":"",n={slate:"bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600",blue:"bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50",red:"bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50",green:"bg-green-100 dark:bg-green-900/30 hover:bg-green-200 dark:hover:bg-green-900/50",yellow:"bg-yellow-100 dark:bg-yellow-900/30 hover:bg-yellow-200 dark:hover:bg-yellow-900/50",orange:"bg-orange-100 dark:bg-orange-900/30 hover:bg-orange-200 dark:hover:bg-orange-900/50",indigo:"bg-indigo-100 dark:bg-indigo-900/30 hover:bg-indigo-200 dark:hover:bg-indigo-900/50",teal:"bg-teal-100 dark:bg-teal-900/30 hover:bg-teal-200 dark:hover:bg-teal-900/50"};return`${i} ${n[t]||n.slate} ${c}`},ce=(t="slate")=>{const a={slate:"text-slate-600 dark:text-slate-400",blue:"text-blue-600 dark:text-blue-400",red:"text-red-600 dark:text-red-400",green:"text-green-600 dark:text-green-400",yellow:"text-yellow-600 dark:text-yellow-400",orange:"text-orange-600 dark:text-orange-400",indigo:"text-indigo-600 dark:text-indigo-400",teal:"text-teal-600 dark:text-teal-400"};return a[t]||a.slate},T=(t="slate")=>{const a={slate:"hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300",blue:"hover:bg-blue-50 dark:hover:bg-blue-900/20 text-blue-600 dark:text-blue-400",red:"hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400",green:"hover:bg-green-50 dark:hover:bg-green-900/20 text-green-600 dark:text-green-400",yellow:"hover:bg-yellow-50 dark:hover:bg-yellow-900/20 text-yellow-600 dark:text-yellow-400",orange:"hover:bg-orange-50 dark:hover:bg-orange-900/20 text-orange-600 dark:text-orange-400",indigo:"hover:bg-indigo-50 dark:hover:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400",teal:"hover:bg-teal-50 dark:hover:bg-teal-900/20 text-teal-600 dark:text-teal-400"};return a[t]||a.slate},xe=({actions:t})=>{const[a,i]=h.useState(!1),c=ie(t).filter(s=>!s.hidden),n=(s,l)=>{s.disabled||(l.preventDefault(),l.stopPropagation(),i(!1),s.onClick(l))},m=()=>P(t)?t.map((s,l)=>{const d=s.actions.filter(o=>!o.hidden);return d.length===0?null:e.jsxs(L.Fragment,{children:[l>0&&e.jsx("div",{className:"my-1 border-t border-slate-100 dark:border-slate-700"}),s.label&&e.jsx("div",{className:"px-4 py-1.5 text-xs font-semibold text-slate-400 uppercase tracking-wider",children:s.label}),d.map((o,j)=>{const k=o.icon;return e.jsxs("button",{onClick:N=>n(o,N),disabled:o.disabled,className:`w-full px-4 py-2.5 text-left flex items-center gap-2 transition-colors text-sm
                                        ${T(o.color)}
                                        ${o.disabled?"opacity-50 cursor-not-allowed":""}
                                    `,children:[e.jsx(k,{size:16}),o.label]},j)})]},l)}):c.map((s,l)=>{const d=s.icon;return e.jsxs("button",{onClick:o=>n(s,o),disabled:s.disabled,className:`w-full px-4 py-2.5 text-left flex items-center gap-2 transition-colors text-sm
                        ${T(s.color)}
                        ${s.disabled?"opacity-50 cursor-not-allowed":""}
                    `,children:[e.jsx(d,{size:16}),s.label]},l)});return e.jsxs("div",{className:"flex items-center justify-end gap-2",onClick:s=>s.preventDefault(),children:[e.jsx("div",{className:"hidden md:flex items-center gap-2",children:c.map((s,l)=>{const d=s.icon;return e.jsx("button",{onClick:o=>n(s,o),disabled:s.disabled,className:de(s.color,s.disabled),title:s.label,children:e.jsx(d,{size:18,className:ce(s.color)})},l)})}),e.jsxs("div",{className:"relative md:hidden",children:[e.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),i(!a)},className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(oe,{size:18,className:"text-slate-600 dark:text-slate-400"})}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:s=>{s.preventDefault(),s.stopPropagation(),i(!1)}}),e.jsx("div",{className:"absolute right-0 mt-2 w-52 bg-white dark:bg-slate-800 rounded-lg shadow-lg border border-slate-200 dark:border-slate-700 z-20 overflow-hidden py-1 animate-in fade-in slide-in-from-top-2",children:m()})]})]})]})},me=({cliente:t,onUpdate:a})=>{const i=I(),[c,n]=h.useState(!1),[m,s]=h.useState(!1),l=async()=>{s(!0);try{await ne.delete(t.id),a&&a()}catch(o){console.error("Erro ao excluir cliente:",o),alert("Erro ao excluir cliente. Por favor, tente novamente.")}finally{s(!1),n(!1)}},d=[{icon:z,label:"Ver Detalhes",onClick:()=>i(`/admin/clientes/${t.id}`),color:"blue"},{icon:B,label:"Editar",onClick:()=>i(`/admin/clientes/${t.id}/editar`),color:"slate"},{icon:S,label:"Excluir",onClick:()=>n(!0),color:"red"}];return e.jsxs(e.Fragment,{children:[e.jsx(xe,{actions:d}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:o=>o.stopPropagation(),children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white mb-2",children:"Confirmar Exclusão"}),e.jsxs("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:["Tem certeza que deseja excluir o cliente ",e.jsx("strong",{children:t.nome}),"? Esta ação não pode ser desfeita."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>n(!1),disabled:m,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:hover:bg-slate-600 text-slate-800 dark:text-white rounded-lg font-semibold transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsxs("button",{onClick:l,disabled:m,className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-semibold transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(S,{size:16}),m?"Excluindo...":"Excluir"]})]})]})})]})},ge=({segmento:t})=>{const a={VIP:{color:"purple",icon:E,label:"VIP",class:"bg-purple-500/15 text-purple-700 dark:text-purple-400 border-purple-500/20"},REGULAR:{color:"blue",icon:u,label:"Regular",class:"bg-blue-500/15 text-blue-700 dark:text-blue-400 border-blue-500/20"},NOVO:{color:"green",icon:$,label:"Novo",class:"bg-emerald-500/15 text-emerald-700 dark:text-emerald-400 border-emerald-500/20"},INATIVO:{color:"slate",icon:u,label:"Inativo",class:"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-500/20"}},i=a[t]||a.REGULAR,c=i.icon;return e.jsxs(_,{variant:"outline",className:Z("flex items-center gap-1 font-bold px-2 py-0.5 rounded-full",i.class),children:[e.jsx(c,{size:12}),i.label]})},Je=A(function(){const{clients:a}=V();D();const[i,c]=h.useState("TODOS"),[n,m]=h.useState(""),s=I(),l=a,d=l.filter(r=>{var w;const p=i==="TODOS"||r.segmento===i,R=n===""||r.nome.toLowerCase().includes(n.toLowerCase())||r.email.toLowerCase().includes(n.toLowerCase())||(r.documento||"").includes(n)||((w=r.telefone)==null?void 0:w.includes(n));return p&&R}),o=l.length,j=l.filter(r=>r.segmento==="VIP").length,k=l.reduce((r,p)=>r+(p.historico_viagens||0),0),N=l.reduce((r,p)=>r+Number(p.valor_total_gasto||0),0);return e.jsxs("div",{className:"p-8 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700 pb-10",children:[e.jsx(X,{title:"Gestão de Clientes (CRM)",subtitle:"Relacionamento e fidelização de passageiros",icon:u,rightElement:e.jsx(U,{asChild:!0,className:"h-14 px-6 rounded-xl font-semibold gap-2 shadow-lg shadow-primary/20",children:e.jsxs(C,{to:"/admin/clients/new",children:[e.jsx($,{size:20,strokeWidth:2.5}),"NOVO CLIENTE"]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(v,{title:"Total de Clientes",value:o,icon:u,variant:"primary"}),e.jsx(v,{title:"Clientes VIP",value:j,icon:E,variant:"purple"}),e.jsx(v,{title:"Total de Viagens",value:k,icon:ee,variant:"blue"}),e.jsx(v,{title:"Receita Total",value:`R$ ${Math.round(N/1e3)}k`,icon:te,variant:"emerald"})]}),e.jsxs(Y,{children:[e.jsxs("div",{className:"space-y-1.5 flex flex-col lg:col-span-2",children:[e.jsx("label",{className:"text-label-caps ml-1",children:"Buscar Cliente"}),e.jsxs("div",{className:"relative group flex-1",children:[e.jsx(se,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground group-focus-within:text-primary transition-colors",size:18}),e.jsx(F,{placeholder:"Nome, email, documento...",className:"pl-12 h-14 bg-muted/40 border-input rounded-xl font-bold transition-all focus-visible:ring-2 focus-visible:ring-primary/20",value:n,onChange:r=>m(r.target.value)})]})]}),e.jsxs("div",{className:"space-y-1.5 flex flex-col lg:col-span-2",children:[e.jsx("label",{className:"text-label-caps ml-1",children:"Segmento do Cliente"}),e.jsx(H,{value:i,onValueChange:c,className:"w-full",children:e.jsxs(W,{className:"bg-muted/40 p-1.5 rounded-xl h-14 flex w-full border border-border/50",children:[e.jsx(f,{value:"TODOS",className:"flex-1 rounded-xl px-2 font-black text-[10px] tracking-widest",children:"TODOS"}),e.jsx(f,{value:"VIP",className:"flex-1 rounded-xl px-2 font-black text-[10px] tracking-widest text-purple-600",children:"VIP"}),e.jsx(f,{value:"REGULAR",className:"flex-1 rounded-xl px-2 font-black text-[10px] tracking-widest text-blue-600",children:"REGULAR"}),e.jsx(f,{value:"NOVO",className:"flex-1 rounded-xl px-2 font-black text-[10px] tracking-widest text-emerald-600",children:"NOVOS"})]})})]})]}),e.jsx(M,{className:"shadow-2xl shadow-muted/20 overflow-hidden rounded-[2.5rem] bg-card/50 backdrop-blur-sm",children:e.jsxs(J,{children:[e.jsx(K,{className:"bg-muted/30",children:e.jsxs(y,{className:"hover:bg-transparent border-border/50",children:[e.jsx(b,{className:"pl-8 h-14 text-table-head",children:"Cliente"}),e.jsx(b,{className:"h-14 text-table-head",children:"Contato"}),e.jsx(b,{className:"h-14 text-table-head text-center",children:"Segmento"}),e.jsx(b,{className:"h-14 text-table-head text-center",children:"Viagens"}),e.jsx(b,{className:"h-14 text-table-head text-right",children:"Receita"}),e.jsx(b,{className:"pr-8 text-right h-14 text-table-head",children:"Ações"})]})}),e.jsx(Q,{children:d.length===0?e.jsx(y,{children:e.jsx(g,{colSpan:6,className:"h-96 text-center border-none",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-20 grayscale opacity-40",children:[e.jsx(u,{size:48}),e.jsx("p",{className:"text-lg font-bold",children:"Nenhum cliente encontrado"})]})})}):d.map(r=>e.jsxs(y,{className:"group hover:bg-muted/20 border-border/30 transition-colors",children:[e.jsx(g,{className:"pl-8 py-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"h-10 w-10 border-2 border-background shadow-sm ring-1 ring-primary/10",children:e.jsx(q,{className:"bg-gradient-to-br from-primary/10 to-purple-600/10 text-primary text-sm font-semibold",children:r.nome.substring(0,2).toUpperCase()})}),e.jsxs("div",{children:[e.jsx(C,{to:`/admin/clients/${r.id}`,className:"font-bold text-sm hover:text-primary transition-colors",children:r.nome}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r.documento||"Sem documento"})]})]})}),e.jsx(g,{className:"py-5",children:e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 font-medium truncate max-w-[200px]",children:[e.jsx(ae,{size:12,className:"text-blue-600"})," ",r.email]}),r.telefone&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(re,{size:12,className:"text-emerald-600"})," ",r.telefone]})]})}),e.jsx(g,{className:"text-center py-5",children:e.jsx(ge,{segmento:r.segmento})}),e.jsx(g,{className:"text-center py-5",children:e.jsx("span",{className:"text-lg font-semibold",children:r.historico_viagens||0})}),e.jsx(g,{className:"text-right py-5",children:e.jsxs("span",{className:"text-sm font-semibold text-emerald-600",children:["R$ ",Number(r.valor_total_gasto||0).toLocaleString("pt-BR")]})}),e.jsx(g,{className:"pr-8 text-right py-5",children:e.jsx(me,{cliente:r,onUpdate:()=>s(".",{replace:!0})})})]},r.id))})]})})]},"clients-main")});export{Je as default};
