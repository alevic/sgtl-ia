import{w as se,u as te,d as ae,b as re,a as le,c as oe}from"./chunk-JZWAC4HX-DumfKpwM.js";import{r as j,j as e,a as de}from"./forgot-password-Cd1Knve9.js";import{B as S}from"./button-D5icbzZz.js";import{C as M}from"./card-Cg68uFrF.js";import{P as ne}from"./PageHeader-BWRrOg2b.js";import{S as Y}from"./search-CnuVL9vz.js";import{C as R}from"./check-DPa0jV58.js";import{C as $}from"./calendar-B2-DO3Xm.js";import{C as D}from"./clock-BRAlDuTD.js";import{M as I}from"./map-pin-BU3OPG7D.js";import{B as F}from"./bus-D0L2JeBO.js";import{U as ie}from"./users-BFoA2Uj7.js";import{C as H}from"./circle-x-Bi7UYLIw.js";import{C as z}from"./circle-check-big-I14bXISs.js";import{L as V}from"./loader-CBdNOhxw.js";import{U as T}from"./user-BQEge37k.js";import{p as C,A as G}from"./types-DFYgxmzW.js";import{c as P}from"./createLucideIcon-C45Xejds.js";import{M as ce}from"./moon-BYP2SUiN.js";import{S as xe}from"./star-jM7IWhSt.js";import{C as B}from"./circle-Inv2uPuq.js";import{L as me}from"./lock-DeC39RxH.js";import"./utils-CDN07tui.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M19 9V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v3",key:"irtipd"}],["path",{d:"M3 16a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V11a2 2 0 0 0-4 0z",key:"1qyhux"}],["path",{d:"M5 18v2",key:"ppbyun"}],["path",{d:"M19 18v2",key:"gy7782"}]],Q=P("armchair",ue);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M2 4v16",key:"vw9hq8"}],["path",{d:"M2 8h18a2 2 0 0 1 2 2v10",key:"1dgv2r"}],["path",{d:"M2 17h20",key:"18nfp3"}],["path",{d:"M6 8v9",key:"1yriud"}]],pe=P("bed",be);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ge=P("crown",he),X=({status:u})=>{const r={SCHEDULED:{color:"yellow",icon:D,label:"Agendada"},AGENDADA:{color:"yellow",icon:D,label:"Agendada"},CONFIRMED:{color:"green",icon:z,label:"Confirmada"},CONFIRMADA:{color:"green",icon:z,label:"Confirmada"},IN_TRANSIT:{color:"blue",icon:V,label:"Em Curso"},EM_CURSO:{color:"blue",icon:V,label:"Em Curso"},COMPLETED:{color:"slate",icon:z,label:"Finalizada"},FINALIZADA:{color:"slate",icon:z,label:"Finalizada"},CANCELLED:{color:"red",icon:H,label:"Cancelada"},CANCELADA:{color:"red",icon:H,label:"Cancelada"},DELAYED:{color:"orange",icon:D,label:"Atrasada"}},i=r[u]||r.SCHEDULED,d=i.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-semibold bg-${i.color}-100 dark:bg-${i.color}-900/30 text-${i.color}-700 dark:text-${i.color}-300`,children:[e.jsx(d,{size:12}),i.label]})},fe=({viagens:u,viagemSelecionada:r,onChange:i})=>{var x;const[d,h]=j.useState(""),[n,m]=j.useState("TODOS"),c=t=>{if(!t)return"Data não definida";try{let o="";if(t instanceof Date?o=t.toISOString().split("T")[0]:typeof t=="string"&&(t.includes("T")?o=t.split("T")[0]:o=t),!o||o.length!==10)return"Data Inválida";const[g,N,p]=o.split("-").map(Number);return new Date(g,N-1,p,12).toLocaleDateString()}catch{return"Erro Data"}},l=u.filter(t=>{var N,p,A,k,_,s;const o=n==="TODOS"||n==="AGENDADA"&&(t.status==="AGENDADA"||t.status==="SCHEDULED")||n==="CONFIRMADA"&&(t.status==="CONFIRMADA"||t.status==="CONFIRMED"),g=d===""||((N=t.titulo)==null?void 0:N.toLowerCase().includes(d.toLowerCase()))||((p=t.origem)==null?void 0:p.toLowerCase().includes(d.toLowerCase()))||((A=t.destino)==null?void 0:A.toLowerCase().includes(d.toLowerCase()))||((k=t.route_name)==null?void 0:k.toLowerCase().includes(d.toLowerCase()))||((_=t.origin_city)==null?void 0:_.toLowerCase().includes(d.toLowerCase()))||((s=t.destination_city)==null?void 0:s.toLowerCase().includes(d.toLowerCase()));return o&&g&&(t.status==="AGENDADA"||t.status==="CONFIRMADA"||t.status==="SCHEDULED"||t.status==="CONFIRMED")});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Y,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por origem, destino ou título...",value:d,onChange:t=>h(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m("TODOS"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${n==="TODOS"?"bg-blue-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Todas"}),e.jsx("button",{onClick:()=>m("AGENDADA"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${n==="AGENDADA"?"bg-yellow-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Agendadas"}),e.jsx("button",{onClick:()=>m("CONFIRMADA"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${n==="CONFIRMADA"?"bg-green-600 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Confirmadas"})]})]}),r&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-500 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-blue-700 dark:text-blue-400 uppercase tracking-wide",children:"Viagem Selecionada"}),e.jsx(R,{size:20,className:"text-blue-600 dark:text-blue-400"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-white",children:r.title||r.titulo||"Viagem sem título"}),e.jsx(X,{status:r.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-slate-600 dark:text-slate-300",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{size:14}),e.jsx("span",{children:c(r.departure_date)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{size:14}),e.jsx("span",{children:(x=r.departure_time)==null?void 0:x.substring(0,5)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{size:14,className:"text-green-600"}),e.jsx("span",{children:r.route_name||r.origem})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{size:14,className:"text-red-600"}),e.jsx("span",{children:r.return_route_name||r.destino})]})]})]}),!r&&e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-4",children:l.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e.jsx(F,{size:48,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Nenhuma viagem disponível"})]}):l.map(t=>{var o,g;return e.jsx("div",{onClick:()=>i(t),className:`cursor-pointer bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 
                                shadow-sm hover:shadow-md hover:border-blue-500 dark:hover:border-blue-500 transition-all overflow-hidden group`,children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:t.title||t.titulo||"Viagem sem título"}),t.trip_type&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-bold bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300 uppercase",children:t.trip_type.replace("_"," ")}),e.jsx(X,{status:t.status})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(I,{size:16,className:"text-green-600 shrink-0"}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:t.route_name||t.origem||"Origem não definida"}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 ml-auto",children:[e.jsx($,{size:12})," ",c(t.departure_date),e.jsx(D,{size:12})," ",(o=t.departure_time)==null?void 0:o.substring(0,5)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(I,{size:16,className:"text-red-600 shrink-0"}),e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:t.return_route_name||t.destino||"Destino não definido"}),(t.arrival_date||t.arrival_time)&&e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 flex items-center gap-1 ml-auto",children:[t.arrival_date&&e.jsxs(e.Fragment,{children:[e.jsx($,{size:12})," ",c(t.arrival_date)]}),t.arrival_time&&e.jsxs(e.Fragment,{children:[e.jsx(D,{size:12})," ",(g=t.arrival_time)==null?void 0:g.substring(0,5)]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-slate-500 dark:text-slate-400 border-t border-slate-100 dark:border-slate-700/50 pt-2",children:[t.vehicle_plate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{size:12}),e.jsx("span",{children:t.vehicle_plate})]}),t.driver_name&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{size:12}),e.jsx("span",{children:t.driver_name})]}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsxs("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:[t.seats_available," lugares livres"]})]})]})})})},t.id)})})]})},je=({clientes:u,clienteSelecionado:r,onSelecionarCliente:i,onNovoCliente:d})=>{const[h,n]=j.useState(""),m=u.filter(l=>l.nome.toLowerCase().includes(h.toLowerCase())||l.email.toLowerCase().includes(h.toLowerCase())||(l.documento||"").includes(h)),c=l=>{i&&((r==null?void 0:r.id)===l.id?i(null):i(l))};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-700 dark:text-slate-200 mb-3",children:"Selecionar Passageiro"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:"Busque e selecione um passageiro, depois escolha um assento no mapa ao lado"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Y,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, email ou documento...",value:h,onChange:l=>n(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-900 text-slate-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),d&&e.jsxs("button",{onClick:l=>{l.preventDefault(),d()},title:"Cadastrar Novo Cliente",className:"p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors flex items-center justify-center min-w-[42px]",children:[e.jsx(T,{size:20}),e.jsx("span",{className:"hidden sm:inline-block ml-2 text-sm font-semibold",children:"Novo"})]})]}),r&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(R,{size:16,className:"text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-slate-800 dark:text-white text-sm truncate",children:r.nome}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate",children:"Agora selecione um assento →"})]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2 border border-slate-200 dark:border-slate-700 rounded-lg p-2",children:m.length>0?m.map(l=>{const x=(r==null?void 0:r.id)===l.id;return e.jsx("button",{onClick:()=>c(l),className:`w-full p-3 rounded-lg border transition-all text-left ${x?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-sm":"border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-blue-700 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${x?"bg-blue-600":"bg-slate-200 dark:bg-slate-700"}`,children:x?e.jsx(R,{size:16,className:"text-white"}):e.jsx(T,{size:16,className:"text-slate-600 dark:text-slate-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`font-semibold ${x?"text-blue-700 dark:text-blue-300":"text-slate-800 dark:text-white"}`,children:l.nome}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate",children:[l.documento," • ",l.email]})]})]})},l.id)}):e.jsxs("div",{className:"text-center py-8 text-slate-500 dark:text-slate-400",children:[e.jsx(T,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Nenhum cliente encontrado"})]})})]})},Ne=({veiculo:u,assentosReservados:r,assentosSelecionados:i,onSelecionarAssento:d,precos:h})=>{const[n,m]=j.useState(1),c=u.mapa_assentos||[],l=h||u.precos_assentos||{},x=Object.keys(l).length>0,t={[C.CONVENCIONAL]:{icon:B,label:"Convencional"},[C.EXECUTIVO]:{icon:xe,label:"Executivo"},[C.SEMI_LEITO]:{icon:Q,label:"Semi-Leito"},[C.LEITO]:{icon:ce,label:"Leito"},[C.CAMA]:{icon:pe,label:"Cama"},[C.CAMA_MASTER]:{icon:ge,label:"Cama Master"},[C.BLOQUEADO]:{icon:Q,label:"Bloqueado"}},o=s=>Number(l&&l[s]||0),g=s=>{r.includes(s.numero)||s.status===G.BLOQUEADO||s.disabled||d({numero:s.numero,tipo:s.tipo,valor:o(s.tipo)})},N=s=>i.some(a=>a.numero===s.numero)?"selecionado":r.includes(s.numero)?"reservado":s.status===G.BLOQUEADO||s.disabled||s.tipo===C.BLOQUEADO?"bloqueado":"livre",p=c.filter(s=>s.andar===n),A=Array.from(new Set(p.map(s=>s.tipo))),k=p.map(s=>Number(s.posicao_x)).filter((s,a,b)=>b.indexOf(s)===a).sort((s,a)=>s-a),_=Math.max(...p.map(s=>Number(s.posicao_y)),0);return c.length===0?e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900 rounded-lg p-8 text-center border border-slate-200 dark:border-slate-700",children:[e.jsx(F,{size:48,className:"mx-auto mb-4 text-slate-300 dark:text-slate-600"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-2",children:"Mapa de assentos não configurado para este veículo."}),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500",children:"Configure o mapa na página de detalhes do veículo."})]}):x?e.jsxs("div",{className:"w-full",children:[u.is_double_deck&&e.jsxs("div",{className:"flex gap-2 border-b border-slate-200 dark:border-slate-700 mb-6 justify-center",children:[e.jsx("button",{onClick:()=>m(1),className:`px-4 py-2 font-medium transition-colors border-b-2 ${n===1?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:"Térreo"}),e.jsx("button",{onClick:()=>m(2),className:`px-4 py-2 font-medium transition-colors border-b-2 ${n===2?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:"Superior"})]}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:"w-20 h-2 bg-slate-300 dark:bg-slate-600 rounded-full mb-1 opacity-50"}),e.jsx("div",{className:"w-16 h-8 bg-slate-200 dark:bg-slate-700/30 rounded-lg flex items-center justify-center border border-slate-300/30 dark:border-slate-600/30",children:e.jsx(F,{size:18,className:"text-slate-400 dark:text-slate-500"})}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mt-2",children:"Frente do Ônibus"})]}),e.jsx("div",{className:"flex justify-center mb-10 overflow-x-auto",children:e.jsx("div",{className:"grid gap-y-3 gap-x-3 p-1",style:{gridTemplateColumns:`repeat(${k.length+1}, auto)`,justifyContent:"center",minWidth:"fit-content"},children:Array.from({length:_+1}).map((s,a)=>{const b=Math.ceil(k.length/2);return e.jsx(de.Fragment,{children:Array.from({length:k.length+1}).map((y,v)=>{if(v===b)return e.jsx("div",{className:"w-8 h-12 flex items-center justify-center",children:e.jsx("span",{className:"text-slate-300 dark:text-slate-600 font-bold text-xs",children:a+1})},`cor-${a}-${v}`);const W=v<b?v:v-1,Z=k[W],f=p.find(q=>q.posicao_y===a&&q.posicao_x===Z);if(!f)return e.jsx("div",{className:"w-12 h-12"},`empty-${a}-${v}`);const w=N(f),U=t[f.tipo]||{icon:B,label:f.tipo},J=U.icon,K=o(f.tipo);let L="relative w-12 h-12 rounded-xl transition-all duration-300 border-2 flex flex-col items-center justify-center gap-0.5 group/seat ",E="text-[12px] font-bold ",O="w-3.5 h-3.5 ";w==="selecionado"?(L+="bg-blue-600 border-blue-500 shadow-lg shadow-blue-500/20 scale-105 z-10 ring-2 ring-blue-400/30",E+="text-white",O+="text-white"):w==="reservado"?(L+="bg-red-50 border-red-200 dark:bg-red-900/10 dark:border-red-800 cursor-not-allowed",E+="text-red-700 dark:text-red-400",O+="text-red-600 dark:text-red-400"):w==="bloqueado"?(L+="bg-slate-50 border-slate-200 dark:bg-slate-900/50 dark:border-slate-800 cursor-not-allowed opacity-80",E+="text-slate-400 dark:text-slate-600",O+="text-slate-400 dark:text-slate-600"):(L+="bg-white dark:bg-slate-800/20 border-slate-200 dark:border-slate-700 hover:border-green-500 hover:bg-green-50 dark:hover:bg-green-900/10 cursor-pointer shadow-sm hover:shadow-md active:scale-95",E+="text-slate-700 dark:text-slate-300 group-hover/seat:text-green-600 dark:group-hover/seat:text-green-400",O+="text-slate-400 dark:text-slate-500 group-hover/seat:text-green-500 dark:group-hover/seat:text-green-400");const ee=f.numero.startsWith("DISABLED_")||f.numero.length>5;return e.jsx("button",{onClick:()=>g(f),disabled:w==="reservado"||w==="bloqueado",className:L,title:w==="bloqueado"?"Bloqueado":`${U.label} - ${w==="reservado"?"Reservado":`R$ ${K.toFixed(2)}`}`,children:w==="bloqueado"?e.jsx(me,{size:16,className:"text-slate-400 dark:text-slate-600"}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:O}),e.jsx("span",{className:E,children:ee?"":f.numero}),w==="livre"&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border border-white dark:border-slate-800"})]})},f.id)})},a)})})}),e.jsxs("div",{className:"pt-6 border-t border-slate-100 dark:border-slate-700 space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[12px] font-bold text-slate-400 dark:text-slate-600 uppercase tracking-widest mb-3 text-center",children:"Legenda"}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3.5 h-3.5 rounded bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 relative",children:e.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-green-500 rounded-full border border-white dark:border-slate-800"})}),e.jsx("span",{className:"text-[12px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:"Livre"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3.5 h-3.5 rounded bg-blue-600 border-2 border-blue-500"}),e.jsx("span",{className:"text-[12px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:"Selecionado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3.5 h-3.5 rounded bg-red-100 dark:bg-red-900/30 border-2 border-red-200 dark:border-red-800"}),e.jsx("span",{className:"text-[12px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:"Ocupado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3.5 h-3.5 rounded bg-slate-100 dark:bg-slate-900/50 border-2 border-slate-200 dark:border-slate-800"}),e.jsx("span",{className:"text-[12px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-tight",children:"Bloqueado"})]})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-4",children:A.map(s=>{const a=t[s]||{icon:B,label:s},b=a.icon;return e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 dark:bg-slate-900/30 rounded-lg border border-slate-100 dark:border-slate-800",children:[e.jsx(b,{className:"w-3.5 h-3.5 text-slate-400 dark:text-slate-500"}),e.jsx("span",{className:"text-[12px] font-bold text-slate-600 dark:text-slate-400 uppercase tracking-tight",children:a.label})]},s)})})]})]}):e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-lg p-6 border border-amber-200 dark:border-amber-800",children:[e.jsx("p",{className:"text-amber-800 dark:text-amber-300 mb-2 font-medium",children:"⚠️ Preços não configurados"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-400",children:"Configure os preços por tipo de assento na página do veículo antes de criar reservas."})]})},Ve=se(function(){const{trips:r,clients:i,vehicles:d}=te();ae(),re(),le();const h=oe(),[n,m]=j.useState(1),[c,l]=j.useState(null),[x,t]=j.useState([]),[o,g]=j.useState({}),[N,p]=j.useState(null);j.useEffect(()=>{if(c){const s=d.find(a=>a.id===c.vehicle_id);p(s||null)}},[c,d]);const A=s=>{t(a=>a.find(y=>y.numero===s.numero)?a.filter(y=>y.numero!==s.numero):[...a,s])},k=(s,a)=>{g(b=>({...b,[s]:{name:a.nome,document:a.documento,client_id:a.id}}))},_=()=>{const s={trip_id:c.id,payment_method:"CASH",reservations:x.map(a=>{var b,y,v;return{seat_number:a.numero,price:a.valor,passenger_name:(b=o[a.numero])==null?void 0:b.name,passenger_document:(y=o[a.numero])==null?void 0:y.document,client_id:(v=o[a.numero])==null?void 0:v.client_id}})};h.submit({intent:"create-reservation",payload:JSON.stringify(s)},{method:"post"})};return e.jsxs("div",{className:"p-8 space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700 pb-10",children:[e.jsx(ne,{title:"Nova Reserva",subtitle:"Emissão de tickets e alocação de passageiros",backLink:"/admin/reservations"}),e.jsx("div",{className:"flex items-center justify-center gap-4 mb-8",children:[1,2,3].map(s=>e.jsx("div",{className:cn("w-10 h-10 rounded-full flex items-center justify-center font-bold",n>=s?"bg-primary text-white":"bg-muted text-muted-foreground"),children:s},s))}),n===1&&e.jsxs(M,{className:"p-8 rounded-3xl shadow-xl space-y-6",children:[e.jsx(fe,{viagens:r,viagemSelecionada:c,onChange:l}),e.jsx(S,{disabled:!c,onClick:()=>m(2),className:"h-14 w-full rounded-xl font-bold",children:"PRÓXIMA ETAPA"})]}),n===2&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsx(M,{className:"lg:col-span-5 p-8 rounded-3xl shadow-xl",children:N&&e.jsx(Ne,{veiculo:N,assentosReservados:[],assentosSelecionados:x,onSelecionarAssento:A,precos:{CONVENCIONAL:100}})}),e.jsxs("div",{className:"lg:col-span-7 space-y-6",children:[x.map(s=>e.jsxs(M,{className:"p-6 rounded-2xl shadow-md border-none bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"font-bold text-xl",children:["Assento ",s.numero]}),e.jsxs(ke,{variant:"outline",children:["R$ ",s.valor.toFixed(2)]})]}),e.jsx(je,{clientes:i,onSelecionarCliente:a=>k(s.numero,a)})]},s.numero)),e.jsx(S,{disabled:x.length===0,onClick:()=>m(3),className:"h-14 w-full rounded-xl font-bold",children:"REVISÃO FINAL"})]})]}),n===3&&e.jsxs(M,{className:"p-8 rounded-3xl shadow-xl space-y-8",children:[e.jsxs("div",{className:"space-y-4 text-center",children:[e.jsx(R,{size:48,className:"mx-auto text-emerald-500"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Confirmação de Reserva"}),e.jsx("p",{className:"text-muted-foreground",children:"Revise os dados antes de finalizar a emissão"})]}),e.jsx("div",{className:"space-y-2",children:x.map(s=>{var a;return e.jsxs("div",{className:"flex justify-between border-b pb-2",children:[e.jsxs("span",{children:[s.numero," - ",(a=o[s.numero])==null?void 0:a.name]}),e.jsxs("span",{className:"font-bold",children:["R$ ",s.valor.toFixed(2)]})]},s.numero)})}),e.jsx(S,{onClick:_,className:"h-14 w-full rounded-xl font-bold bg-emerald-600 hover:bg-emerald-700",children:"FINALIZAR E EMITIR TICKETS"}),e.jsx(S,{variant:"ghost",onClick:()=>m(2),className:"w-full",children:"Voltar"})]})]})}),ke=({children:u,variant:r})=>e.jsx("span",{className:cn("px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-widest",r==="outline"?"border":"bg-primary text-white"),children:u});export{Ve as default};
